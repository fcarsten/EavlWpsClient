# wps.des: meanACF, title = Mean Autocorrelation;
# wps.in: dataStr, string, DATA seperated by comma in one line;
# wps.off;
dataStr=paste("UGD1944,65.34,UGD1944,59.795,UGD1944,47.02,UGD1944,52.34,UGD1944,78.59,UGD1944,93.95,UGD1944,86.365,UGD1944,71.615,UGD1944,57.69,",

              "UGD1939R,107.07,UGD1939R,32.07,UGD1939R,0.895,UGD1939R,2.225,UGD1939R,2.755,UGD1939R,2.135,UGD1939R,3.16,UGD1939R,4.02")
#,UGD1939R,4.51,UGD1939R,4.34,UGD1939R,4.145,UGD1939R,4.035,UGD1939R,3.67,UGD1939R,3.755,UGD1939R,3.47,UGD1939R,2.865,UGD1939R,2.605,UGD1939R,2.24,UGD1939R,1.535,UGD1939R,0.94,UGD1939R,0.71,UGD1939R,0.535,UGD1939R,0.64,UGD1939R,104.856,UGD1939R,122.6,UGD1939R,108.609,UGD1939R,94.5,UGD1939R,83.77,UGD1939R,97.185,UGD1939R,97.225,UGD1939R,78.095,UGD1939R,80.17,UGD1939R,95.895,UGD1939R,105.15,UGD1939R,89.895,UGD1939R,80.31,UGD1939R,85.785,UGD1939R,67.493,UGD1939R,69.86,UGD1939R,77.085,UGD1939R,82.27,UGD1939R,98.84,UGD1939R,101.31,UGD1939R,51.04,UGD1939R,43.295,UGD1939R,66.474,UGD1939R,74.34,UGD1939R,74.135,UGD1939R,75.295,UGD1939R,79.06,UGD1939R,74.528,UGD1939R,57.565,UGD1939R,51.435,UGD1939R,66.89,UGD1939R,76.61,UGD1939R,72.275,UGD1939R,93.961,UGD1939R,101.482,UGD1939R,90.26,UGD1939R,83.185,UGD1939R,94.22,UGD1939R,96.745,UGD1939R,100.13,UGD1939R,96.55,UGD1939R,63.103,UGD1939R,55.498,UGD1939R,58.273,UGD1939R,59.66,UGD1939R,74.25,UGD1939R,65.782,UGD1939R,74.235,UGD1939R,77.405,UGD1939R,81.01,UGD1939R,72.12,UGD1939R,70.76,UGD1939R,75.59,UGD1939R,85.256,UGD1939R,74.005,UGD1939R,69.16,UGD1939R,82.435,UGD1939R,100.034,UGD1939R,136.53,UGD1939R,92.995,UGD1939R,58.69,UGD1939R,50.17,UGD1939R,56.58,UGD1939R,82.32,UGD1939R,110.69,UGD1939R,94.405,UGD1939R,80.37,UGD1939R,79.99,UGD1939R,69.99,UGD1939R,85.735,UGD1939R,88.93,UGD1939R,64.165,UGD1939R,54.282,UGD1939R,63.02,UGD1939R,66.995,UGD1939R,62.245,UGD1939R,61.66,UGD1939R,63.815,UGD1939R,86.292,UGD1939R,78.525,UGD1939R,69.59,UGD1939R,57.84,UGD1939R,60.89,UGD1939R,71.23,UGD1939R,65.725,UGD1939R,93.703,UGD1939R,128.622,UGD1939R,123.033,UGD1939R,40.607,UGD1939R,13.085,UGD1939R,34.125,UGD1939R,26.3,UGD1939R,32.275,UGD1939R,75.501,UGD1939R,37.82,UGD1939R,35.65,UGD1939R,35.5,UGD1939R,38.09,UGD1939R,64.885,UGD1939R,83.09,UGD1939R,76.375,UGD1939R,70.86,UGD1939R,65.82,UGD1939R,43.975,UGD1939R,24.375,UGD1939R,41.805,UGD1939R,75.722,UGD1939R,40.29,UGD1939R,59.675,UGD1939R,67.27,UGD1939R,51.515,UGD1939R,36.62,UGD1939R,34.575,UGD1939R,86.882,UGD1939R,61.78,UGD1939R,64.222,UGD1939R,29.61,UGD1939R,35.415,UGD1939R,47.934,UGD1939R,56.24,UGD1939R,55.675,UGD1939R,46.42,UGD1939R,51.744,UGD1939R,49.334,UGD1939R,91.597,UGD1939R,67.148,UGD1939R,114.279,UGD1939R,128.73,UGD1939R,65.92,UGD1939R,60.445,UGD1939R,40.64,UGD1939R,32.865,UGD1939R,24.02,UGD1939R,34.53,UGD1939R,59.295,UGD1939R,58.875,UGD1939R,52.915,UGD1939R,62.27,UGD1939R,86.29,UGD1939R,125.792,UGD1939R,100.168,UGD1939R,77.145,UGD1939R,60.485,UGD1939R,60.66,UGD1939R,98.321,UGD1939R,128.395,UGD1939R,98.4,UGD1939R,75.878,UGD1939R,86.211,UGD1939R,84.864,UGD1939R,127.357,UGD1939R,114.054,UGD1939R,56.93,UGD1939R,55.83,UGD1939R,64.305,UGD1939R,73.5665,UGD1939R,75.694,UGD1939R,73.89,UGD1939R,65.85,UGD1940R,99.21,UGD1940R,87.865,UGD1940R,75.39,UGD1940R,64.945,UGD1940R,58.64,UGD1940R,60.215,UGD1940R,53.09,UGD1940R,49.9,UGD1940R,51.71,UGD1940R,60.505,UGD1940R,66.155,UGD1940R,70.27,UGD1940R,82.67,UGD1940R,73.4,UGD1940R,68.07,UGD1940R,58.08,UGD1940R,29.435,UGD1940R,19.39,UGD1940R,38.12,UGD1940R,44.16,UGD1940R,23.745,UGD1940R,21.33,UGD1940R,22.825,UGD1940R,19.395,UGD1940R,12.155,UGD1940R,24.755,UGD1940R,38.88,UGD1940R,25.855,UGD1940R,28.77,UGD1940R,32.235,UGD1940R,26.355,UGD1940R,39.73,UGD1940R,47.045,UGD1940R,24.77,UGD1940R,10.495,UGD1940R,27.8,UGD1940R,31.855,UGD1940R,21.71,UGD1940R,23.365,UGD1940R,17.17,UGD1940R,8.265,UGD1940R,5.11,UGD1940R,12.31,UGD1940R,34.35,UGD1940R,53.25,UGD1940R,61.265,UGD1940R,54.945,UGD1940R,51.565,UGD1940R,61.515,UGD1940R,94.265,UGD1940R,97.136,UGD1940R,92.072,UGD1940R,88.357,UGD1940R,73.914,UGD1940R,84.199,UGD1940R,12.075,UGD1940R,2.335,UGD1940R,0.68,UGD1940R,22.1925,UGD1940R,72.555,UGD1940R,43.215,UGD1940R,94.476,UGD1940R,52.855,UGD1940R,10.625,UGD1940R,1.765,UGD1940R,2.5,UGD1940R,4.15,UGD1940R,6.28,UGD1940R,7.625,UGD1940R,14.93,UGD1940R,27.25,UGD1940R,23.225,UGD1940R,23.47,UGD1940R,27.16,UGD1940R,20.69,UGD1940R,17.125,UGD1940R,13.74,UGD1940R,11.785,UGD1940R,7.235,UGD1940R,3.835,UGD1940R,2.87,UGD1940R,1.955,UGD1940R,27.085,UGD1940R,65.34,UGD1940R,79.055,UGD1940R,61.62,UGD1940R,53.84,UGD1940R,80.87,UGD1940R,59.05,UGD1940R,76.974,UGD1940R,89.67,UGD1940R,85.425,UGD1940R,76.096,UGD1940R,64.91,UGD1940R,87.06,UGD1940R,81.295,UGD1940R,77.63,UGD1940R,94.825,UGD1940R,87.995,UGD1940R,85.475,UGD1940R,73.19,UGD1940R,58.06,UGD1940R,64.05,UGD1940R,87.83,UGD1940R,80.97,UGD1940R,56,UGD1940R,52.585,UGD1940R,71.005,UGD1940R,96.45,UGD1940R,70.938,UGD1940R,61.27,UGD1940R,58.805,UGD1940R,70.18,UGD1940R,78.35,UGD1940R,67.394,UGD1940R,82.655,UGD1940R,103.48,UGD1940R,92.245,UGD1940R,69.829,UGD1940R,40.935,UGD1940R,34.145,UGD1940R,32.84,UGD1940R,40.045,UGD1940R,64.865,UGD1940R,86.462,UGD1940R,34.88,UGD1940R,23.66,UGD1940R,35.955,UGD1940R,30.66,UGD1940R,24.365,UGD1940R,31.375,UGD1940R,37.645,UGD1940R,56.33,UGD1940R,103.517,UGD1940R,72.795,UGD1940R,82.205,UGD1940R,45.381,UGD1940R,48.795,UGD1940R,44.69,UGD1940R,37.235,UGD1940R,59.005,UGD1940R,80.475,UGD1940R,75.935,UGD1940R,53.575,UGD1940R,34.095,UGD1940R,24.32,UGD1940R,26.31,UGD1940R,36.725,UGD1940R,59.19,UGD1940R,78.52,UGD1940R,63.41,UGD1940R,56.215,UGD1940R,56.445,UGD1940R,43.005,UGD1940R,38.645,UGD1940R,47.185,UGD1940R,44.88,UGD1940R,58.655,UGD1940R,95.2,UGD1940R,86.277,UGD1940R,57.495,UGD1940R,51.125,UGD1940R,52.32,UGD1940R,52.89,UGD1940R,70.85,UGD1940R,87.035,UGD1940R,89.646,UGD1940R,87.165,UGD1940R,68.81,UGD1940R,67.93,UGD1940R,69.635,UGD1940R,61.975,UGD1940R,29.12,UGD1940R,23.34,UGD1940R,59.088,UGD1940R,102.7,UGD1940R,117.82,UGD1940R,91.64,UGD1940R,107.835,UGD1940R,103.95,UGD1940R,67.975,UGD1940R,53.055,UGD1940R,43.125,UGD1940R,46.525,UGD1940R,52.435,UGD1940R,39.53,UGD1940R,45.355,UGD1940R,58.025,UGD1940R,38.71,UGD1940R,44.81,UGD1940R,56.105,UGD1940R,55.255,UGD1940R,89.402,UGD1940R,113.332,UGD1940R,69.372,UGD1940R,71.313,UGD1940R,71.612,UGD1940R,71.907,UGD1940R,54.366,UGD1940R,45.674,UGD1940R,82.68,UGD1940R,105.7,UGD1940R,97.435,UGD1940R,73.065,UGD1940R,61.6,UGD1940R,75.63,UGD1940R,88.896,UGD1940R,70.08,UGD1940R,57.885,UGD1940R,44.41,UGD1940R,46.51,UGD1940R,89.983,UGD1940R,69.49,UGD1940R,55.305,UGD1940R,48.495,UGD1940R,64.227,UGD1940R,62.38,UGD1940R,55.705,UGD1940R,61.03,UGD1940R,65.725,UGD1940R,56.56,UGD1940R,38.255,UGD1940R,36.145,UGD1940R,29.445,UGD1940R,37.585,UGD1940R,50.26,UGD1940R,42.97,UGD1940R,47.015,UGD1940R,44.445,UGD1940R,43.885,UGD1940R,43.99,UGD1940R,88.628,UGD1940R,64.265,UGD1940R,52.845,UGD1940R,69.235,UGD1940R,82.645,UGD1940R,74.675,UGD1940R,41.52,UGD1940R,40.54,UGD1940R,48.99,UGD1940R,46.7,UGD1940R,40.1,UGD1940R,32.625,UGD1940R,44.69,UGD1940R,36.675,UGD1940R,33.12,UGD1940R,62.085,UGD1940R,57.85,UGD1940R,38.705,UGD1940R,27.715,UGD1940R,74.312,UGD1940R,90.645,UGD1940R,104.565,UGD1940R,75.625,UGD1940R,124.88,UGD1940R,94.09,UGD1940R,110.72,UGD1940R,93.83,UGD1940R,75.306,UGD1940R,78.275,UGD1940R,64.32,UGD1940R,65.035,UGD1940R,65.49,UGD1940R,53.078,UGD1940R,74.358,UGD1940R,63.318,UGD1940R,28.125,UGD1940R,18.59,UGD1940R,12.76,UGD1940R,32.49,UGD1940R,43.675,UGD1940R,54.51,UGD1940R,67.165,UGD1940R,53.38,UGD1940R,26.815,UGD1940R,23.54,UGD1940R,69.11,UGD1940R,89.857,UGD1940R,31.75,UGD1940R,17.995,UGD1940R,17.785,UGD1940R,33.78,UGD1940R,47.3,UGD1940R,36.025,UGD1940R,38.685,UGD1940R,52.896,UGD1940R,41.227,UGD1940R,60.895,UGD1940R,69.45,UGD1940R,58.605,UGD1940R,55.875,UGD1940R,79.375,UGD1940R,60.175,UGD1940R,53.62,UGD1940R,50.816,UGD1940R,57.472,UGD1940R,82.843,UGD1940R,45.2,UGD1940R,53.61,UGD1940R,81.88,UGD1940R,84.296,UGD1940R,52.625,UGD1940R,40.335,UGD1940R,24.9,UGD1940R,32.94,UGD1940R,26.52,UGD1940R,35.102,UGD1940R,98.94,UGD1940R,47.504,UGD1940R,25.045,UGD1940R,41.915,UGD1940R,47.165,UGD1940R,32.35,UGD1940R,34.94,UGD1940R,40.575,UGD1940R,41.13,UGD1940R,53.95,UGD1940R,49.56,UGD1940R,52.57,UGD1940R,61.735,UGD1940R,52.84,UGD1940R,49.855,UGD1940R,61.895,UGD1940R,64.58,UGD1940R,58.38,UGD1940R,80.936,UGD1940R,90.01,UGD1940R,93.96,UGD1940R,90.686,UGD1940R,63.21,UGD1940R,66.32,UGD1940R,90.565,UGD1940R,100.904,UGD1940R,99.87,UGD1940R,89.946,UGD1940R,74.245,UGD1940R,65.885,UGD1940R,58.865,UGD1940R,49.1,UGD1940R,61.78,UGD1940R,55.965,UGD1940R,51.8,UGD1940R,53.49,UGD1940R,30.295,UGD1940R,22.855,UGD1940R,34.915,UGD1940R,29.95,UGD1940R,33.985,UGD1940R,72.274,UGD1940R,93.155,UGD1940R,62.97,UGD1940R,93.96,UGD1940R,91.305,UGD1940R,60.255,UGD1940R,43.52,UGD1940R,55.675,UGD1940R,74.785,UGD1940R,62.75,UGD1940R,40.72,UGD1940R,37.23,UGD1941R,77.3,UGD1941R,78.195,UGD1941R,79.345,UGD1941R,78.87,UGD1941R,72.375,UGD1941R,56.65,UGD1941R,56.835,UGD1941R,71.43,UGD1941R,83.35,UGD1941R,79.035,UGD1941R,74.78,UGD1941R,48.975,UGD1941R,23.28,UGD1941R,43.27,UGD1941R,55.335,UGD1941R,50.605,UGD1941R,43.4,UGD1941R,36.41,UGD1941R,26.55,UGD1941R,10.822,UGD1941R,41.212,UGD1941R,16.176,UGD1941R,2.314,UGD1941R,3.5,UGD1941R,4.66,UGD1941R,6.28,UGD1941R,17.13,UGD1941R,18.995,UGD1941R,10.83,UGD1941R,11.885,UGD1941R,9.69,UGD1941R,11.17,UGD1941R,10.975,UGD1941R,9.455,UGD1941R,16.15,UGD1941R,11.555,UGD1941R,15.085,UGD1941R,35.49,UGD1941R,46.625,UGD1941R,44.675,UGD1941R,43.525,UGD1941R,81.212,UGD1941R,88.24,UGD1941R,70.235,UGD1941R,89.571,UGD1941R,104.375,UGD1941R,112.125,UGD1941R,65.0195,UGD1941R,14.105,UGD1941R,24.48,UGD1941R,8.25,UGD1941R,4.975,UGD1941R,60.327,UGD1941R,110.675,UGD1941R,136.285,UGD1941R,98.15,UGD1941R,23.015,UGD1941R,4.175,UGD1941R,4.405,UGD1941R,3.41,UGD1941R,3.915,UGD1941R,6.686,UGD1941R,18.19,UGD1941R,26.305,UGD1941R,26.925,UGD1941R,23.81,UGD1941R,16.51,UGD1941R,9.62,UGD1941R,18.395,UGD1941R,36.35,UGD1941R,31.14,UGD1941R,23.16,UGD1941R,45.62,UGD1941R,89.67,UGD1941R,104.33,UGD1941R,73.7,UGD1941R,42.3,UGD1941R,18.425,UGD1941R,4.93,UGD1941R,15.355,UGD1941R,33.94,UGD1941R,43.725,UGD1941R,42.26,UGD1941R,46.68,UGD1941R,68.715,UGD1941R,96.017,UGD1941R,64.885,UGD1941R,40.7,UGD1941R,31.935,UGD1941R,32.56,UGD1941R,36.14,UGD1941R,37.275,UGD1941R,41.115,UGD1941R,43.075,UGD1941R,44.285,UGD1941R,53.305,UGD1941R,49.945,UGD1941R,49.625,UGD1941R,44.455,UGD1941R,33.185,UGD1941R,43.575,UGD1941R,56.44,UGD1941R,41.865,UGD1941R,53.079,UGD1941R,63.395,UGD1941R,45.865,UGD1941R,81.34,UGD1941R,56.6025,UGD1941R,52.605,UGD1941R,52.89,UGD1941R,44.444,UGD1941R,41.315,UGD1941R,49.484,UGD1941R,81.235,UGD1941R,76.272,UGD1941R,46.82,UGD1941R,37.605,UGD1941R,54.175,UGD1941R,63.815,UGD1941R,58.76,UGD1941R,48.975,UGD1941R,51.31,UGD1941R,58.635,UGD1941R,59.506,UGD1941R,76.46,UGD1941R,63.14,UGD1941R,46.87,UGD1941R,62.978,UGD1941R,48.575,UGD1941R,44.58,UGD1941R,40.755,UGD1941R,42.225,UGD1941R,55.705,UGD1941R,53.005,UGD1941R,41.86,UGD1941R,46.955,UGD1941R,55.93,UGD1941R,49.21,UGD1941R,39.6,UGD1941R,60.085,UGD1941R,78.915,UGD1941R,55.74,UGD1941R,40.814,UGD1941R,57.42,UGD1941R,73.07,UGD1941R,116.407,UGD1941R,141.614,UGD1941R,94.731,UGD1941R,56.025,UGD1941R,70.885,UGD1941R,61.715,UGD1941R,59.788,UGD1941R,67.77,UGD1941R,71.92,UGD1941R,69.75,UGD1941R,62.75,UGD1941R,69.995,UGD1941R,62.21,UGD1941R,66.535,UGD1941R,66.085,UGD1941R,60.745,UGD1941R,56.97,UGD1941R,46.545,UGD1941R,51.445,UGD1941R,60.53,UGD1941R,69.91,UGD1941R,63.66,UGD1941R,52.555,UGD1941R,64.926,UGD1941R,84.615,UGD1941R,65.208,UGD1941R,54.21,UGD1941R,43.21,UGD1941R,41.6,UGD1941R,41.6,UGD1941R,44,UGD1941R,48.415,UGD1941R,51.415,UGD1941R,49.68,UGD1941R,67.585,UGD1941R,72.59,UGD1941R,64.965,UGD1941R,80.69,UGD1941R,55.425,UGD1941R,51.906,UGD1941R,51.7,UGD1941R,67.655,UGD1941R,43.59,UGD1941R,52.46,UGD1941R,53.255,UGD1941R,55.975,UGD1941R,68.7175,UGD1941R,119.67,UGD1941R,77.983,UGD1941R,55.16,UGD1941R,46.9,UGD1941R,58.719,UGD1941R,69.237,UGD1941R,56.02,UGD1941R,53.44,UGD1941R,53.25,UGD1941R,58.648,UGD1941R,51.26,UGD1941R,51.115,UGD1941R,49.83,UGD1941R,53.62,UGD1941R,56.195,UGD1941R,57.13,UGD1941R,77.355,UGD1941R,83.092,UGD1941R,98.956,UGD1941R,85.026,UGD1941R,45.125,UGD1941R,53.105,UGD1941R,70.645,UGD1941R,63.998,UGD1941R,77.39,UGD1941R,77.8135,UGD1941R,104.855,UGD1941R,103.675,UGD1941R,76.54,UGD1941R,62.195,UGD1941R,55.67,UGD1941R,42.875,UGD1941R,42.91,UGD1941R,56.675,UGD1941R,59.325,UGD1941R,49.515,UGD1941R,42.27,UGD1941R,52.265,UGD1941R,43.265,UGD1941R,45.27,UGD1941R,42.52,UGD1941R,38.61,UGD1941R,41.23,UGD1941R,39.265,UGD1941R,35.815,UGD1941R,40.25,UGD1941R,43.865,UGD1941R,70.28,UGD1941R,71.22,UGD1941R,63.29,UGD1941R,56.69,UGD1941R,55.76,UGD1941R,53.285,UGD1941R,34.98,UGD1941R,26.475,UGD1941R,32.25,UGD1941R,32.87,UGD1941R,34.855,UGD1941R,36.975,UGD1941R,45.66,UGD1941R,41.585,UGD1941R,71.944,UGD1941R,43.77,UGD1941R,40.2,UGD1941R,32.505,UGD1941R,17.265,UGD1941R,11.86,UGD1941R,26.12,UGD1941R,36.135,UGD1941R,29.27,UGD1941R,31.425,UGD1941R,35.835,UGD1941R,33.755,UGD1941R,39.065,UGD1941R,56.911,UGD1941R,83.303,UGD1941R,54,UGD1941R,36.98,UGD1941R,34.06,UGD1941R,47.295,UGD1941R,46.355,UGD1941R,33.17,UGD1941R,36,UGD1941R,49.66,UGD1941R,50.405,UGD1941R,46.2,UGD1941R,47.82,UGD1941R,55.59,UGD1941R,88.33,UGD1941R,102.187,UGD1941R,107.628,UGD1941R,73.4,UGD1941R,59.335,UGD1941R,53.25,UGD1941R,43.755,UGD1941R,59.89,UGD1941R,64.67,UGD1941R,36.27,UGD1941R,24.18,UGD1941R,39.165,UGD1941R,69.203,UGD1941R,91.16,UGD1941R,49.22,UGD1941R,36.625,UGD1941R,29.36,UGD1941R,36.8,UGD1941R,47.53,UGD1941R,39.23,UGD1941R,47.487,UGD1941R,40.145,UGD1941R,48.8,UGD1941R,57.06,UGD1941R,53.825,UGD1941R,43.23,UGD1941R,37.37,UGD1941R,48.235,UGD1941R,54.74,UGD1941R,40.085,UGD1941R,40.112,UGD1941R,78.504,UGD1941R,54.905,UGD1941R,53.14,UGD1941R,66.03,UGD1941R,63.797,UGD1941R,39.194,UGD1941R,34.836,UGD1941R,41.4,UGD1941R,38.425,UGD1941R,51.38,UGD1941R,68.49"
# wps.on;
#THIS FILE CONTAINS THE METHODS FOR RUNNING THE R SCRIPT

holeidCol=1
elementCol=2
#1. IMPORT
# compdata=read.csv(datafile)
dataVector=read.table(header=F, sep=",", text=dataStr)
data=matrix(dataVector, nrow=length(dataVector)/2, ncol = 2, byrow=T)

#2. PREPROCESSING

holeid_all = unique(data[,holeidCol])
nH=length(holeid_all)
lag=20
acfAll=matrix(data=NA,nrow=nH,ncol=lag)
ci=rep(NA,nH)
for (h in 1:nH) {
  dhe=subset(data[,elementCol],data$V1==holeid_all[h])
  acfe=as.vector(acf(dhe,plot=FALSE)$acf)
  acfAll[h,]=acfe[1:lag]
  ci[h]=2/(sqrt(length(dhe)))
}
acfMean=colMeans(acfAll)
ciMean=mean(ci)
compdata = list(acf=acfMean,ci=ciMean)

output = "meanacfout"
write.table(compdata, output,row.names=FALSE, sep=",", col.names=FALSE)
#zz = textConnection("outputStr", "w")
#write.csv(compdata, zz, row.names=FALSE)
#outputStrNN=paste(outputStr, sep="\\n")
# outputStr = textConnectionValue(zz)
# wps.out: output, text;